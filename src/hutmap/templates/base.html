{% load staticfiles %}
{% load compress %}

<!DOCTYPE html>
<html ng-app="hutmap" lang="en">

<head>
  
  <!-- Favicon -->
  <link rel="shortcut icon" href="{% static "hutmap/img/logo-icon-dark.ico" %}">

  {% include metadata %}

	<!-- CSS -->	
  {% compress css %}
  <link rel="stylesheet" type="text/less" charset="utf-8" href="{% static "hutmap/css/hutmap.less" %}">
  <link rel="stylesheet" type="text/css"  charset="utf-8" href="{% static "hutmap/js/bower_components/select2/select2.css" %}">
  {% endcompress %}
  
  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

	<!-- Google Analytics -->
	<script type="text/javascript">

    var hutmap = hutmap || {};
    hutmap.GOOGLE_ANALYTICS_KEY = 'UA-40265178-1';

		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', hutmap.GOOGLE_ANALYTICS_KEY]);
		_gaq.push(['_trackPageview']);
		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>

</head>

<body>

  <div ng-controller="HutmapCtrl">

    <span ng-cloak>
    <script type="text/ng-template" id="template/typeahead/typeahead-popup.html">
      {% include "partials/components/typeahead-popup.html" %}
    </script>
    <script type="text/ng-template" id="template/typeahead/typeahead-match.html">
      {% include "partials/components/typeahead-match.html" %}
    </script>
    <script type="text/ng-template" id="template/tooltip/tooltip-popup.html">
      {% include "partials/components/tooltip-popup.html" %}
    </script>
    </span>

    <div id="navbar" class="navbar navbar-inverse navbar-fixed-top">
      <div id="brand">
        <a id="logo" href="/">
          <img src="{% static "hutmap/img/logo-icon-light20x20.png" %}"/>
          <span>Hutmap</span>
        </a>
      </div>
      <img id="triangle" src="{% static "hutmap/img/triangle-right.png" %}" />
      
      <form id="navbar-search" class="navbar-search" ng-controller="SearchCtrl" ng-submit="search(selected)">
          <input type="text" 
                 class="search-query" 
                 placeholder="Find backcountry huts" 
                 autocomplete="off"
                 ng-model="selected" 
                 typeahead="place as place.description for place in getPlaces($viewValue)"
                 />
          <span class="search-icon">
            <span ng-class="{
              'icon-search': !submitting && !autocompleting,
              'img-spinner': submitting || autocompleting
            }"></span>
            <button class="transparent" type="submit">
              <span class="visuallyhidden">Search</span>
            </button>
          </span>
        </form>
        
        <ul class="nav">
          <li ng-class="{ active: ui.$route.current.active == '{% url 'huts:map' %}'}">
            <a href="{% url 'huts:map' %}">
              Map
            </a>
          </li>
          <li ng-class="{ active: ui.$route.current.active == '{% url 'huts:about' %}'}">
            <a href="{% url 'huts:about' %}">
              About
            </a>
          </li>
        </ul>
        
      <!--
      <div id="navbar-inner">
        
        
        <a id="brand" href="/"><i class="img-logo up1"></i><span class="logo">Hutmap</span>
        </a>
        <form id="navbar-search" class="navbar-search" ng-controller="SearchCtrl" ng-submit="search(selected)">
          <img style="z-index: 10;position: absolute;" src="{% static "hutmap/img/triangle-right.png" %}" />
          <input type="text" 
                 class="search-query" 
                 placeholder="Find backcountry huts" 
                 autocomplete="off"
                 ng-model="selected" 
                 typeahead="place as place.description for place in getPlaces($viewValue)"
                 />
          <span class="search-icon">
            <span ng-class="{
              'icon-search': !submitting && !autocompleting,
              'img-spinner': submitting || autocompleting
            }"></span>
            <button class="transparent" type="submit">
              <span class="visuallyhidden">Search</span>
            </button>
          </span>
        </form>
        
        <ul class="nav">
          <li ng-class="{ active: ui.$route.current.active == '{% url 'huts:map' %}'}">
            <a href="{% url 'huts:map' %}">
              Map
            </a>
          </li>
          <li ng-class="{ active: ui.$route.current.active == '{% url 'huts:about' %}'}">
            <a href="{% url 'huts:about' %}">
              About
            </a>
          </li>
        </ul>
        
      </div>
      -->
      <!-- AddThis Buttons -->
			<div id="share_controls" class="addthis_toolbox addthis_default_style" >
				<a class="addthis_button_facebook_like" fb:like:layout="button_count" addthis:url="http://www.facebook.com/Hutmap"></a>
				<!--<a class="addthis_button_twitter_follow_native" tw:screen_name="Hutmap" tw:show-count="false" tw:show-screen-name="false"/>-->
				<a class="addthis_counter addthis_pill_style" addthis:url="http://www.hutmap.com"></a>	
			</div>

    </div>

    <div id="content" ng-cloak>
      <ng-view></ng-view>
    </div>

  </div>

  <script type="text/javascript">

    var hutmap = hutmap || {};
    hutmap.STATIC_URL = '{{ STATIC_URL }}';
    hutmap.GOOGLE_API_KEY = '{{ GOOGLE_API_KEY }}';
    hutmap.url = {{ hut_urls|safe }};

    var addthis_config = {
      data_track_addressbar: false,
      data_track_clickback: false,
      data_ga_property: hutmap.GOOGLE_ANALYTICS_KEY
    };

  </script>
  <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-51390d312330c4fe"></script>
  <script src="//apis.google.com/js/client.js"></script>
  <script src="//maps.googleapis.com/maps/api/js?v=3.12&sensor=false&libraries=places&key={{ GOOGLE_API_KEY }}"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular-resource.min.js"></script>
  {% compress js %}
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/keydragzoom.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/bower_components/AngularGM/angular-gm.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/bower_components/angular-ui-bootstrap-bower/ui-bootstrap.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/bower_components/select2/select2.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/bower_components/angular-ui-select2/src/select2.js" %}"></script>
  {% compress js %}
  {% endcompress %}
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/app.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/services/module.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/module.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/filters.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/directives.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/services/Huts.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/services/Places.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/services/MarkerTooltip.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/services/gapi.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/services/utils.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/HutmapCtrl.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/CarouselCtrl.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/AlertCtrl.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/BottomBarCtrl.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/HutImgCtrl.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/HutCtrl.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/MapCtrl.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/MapConfigCtrl.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/SearchCtrl.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/FilterCtrl.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/LinkCtrl.js" %}"></script>
  <script type="text/javascript" charset="utf-8" src="{% static "hutmap/js/hutmap/controllers/HutFormCtrl.js" %}"></script>
  {% endcompress %}

</body>
</html>

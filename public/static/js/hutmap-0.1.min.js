/*
 MIT License, http://www.opensource.org/licenses/MIT
*/
'use strict';(function(){angular.module("AngularGM",[]).value("angulargmDefaults",{mapOptions:{zoom:8,center:new google.maps.LatLng(46,-120),mapTypeId:google.maps.MapTypeId.ROADMAP}})})();
(function(){angular.module("AngularGM").directive("gmMap",["$timeout",function(b){return{restrict:"AE",priority:100,template:'<div><div id="" style="width:100%;height:100%;"></div><div ng-transclude></div></div>',transclude:!0,replace:!0,scope:{gmCenter:"=",gmZoom:"=",gmBounds:"=",gmMapOptions:"&",gmMapId:"&"},controller:"angulargmMapController",link:function(a,e,c,d){if(angular.isDefined(a.gmCenter)||(a.center={}),angular.isDefined(a.gmBounds)||(a.bounds={}),!angular.isDefined(a.gmMapId))throw"angulargm must have non-empty gmMapId attribute";
var g=!1,h=!1,f=!1;c.hasOwnProperty("gmCenter")&&(g=!0);c.hasOwnProperty("gmZoom")&&(h=!0);c.hasOwnProperty("gmBounds")&&(f=!0);e=function(){b(function(){(g||h||f)&&a.$apply(function(){if(g&&(a.gmCenter=d.center),h&&(a.gmZoom=d.zoom),f){var b=d.bounds;b&&(a.gmBounds=b)}})})};d.addMapListener("drag",e);d.addMapListener("zoom_changed",e);d.addMapListener("center_changed",e);d.addMapListener("bounds_changed",e);g&&a.$watch("gmCenter",function(a,b){a!==b&&!d.dragging&&a&&(d.center=a)},!0);h&&a.$watch("gmZoom",
function(a,b){null!=a&&!isNaN(a)&&a!==b&&(d.zoom=a)});f&&a.$watch("gmBounds",function(a,b){a!==b&&!d.dragging&&a&&(d.bounds=a)})}}}])})();
(function(){angular.module("AngularGM").directive("gmMarkers",["$log","$parse","$timeout","angulargmUtils",function(b,a,e,c){c.latLngEqual;var d=c.objToLatLng;return{restrict:"AE",priority:100,scope:{gmObjects:"&",gmGetLatLng:"&",gmGetMarkerOptions:"&",gmEvent:"&"},require:"^gmMap",link:function(b,c,f,k){if(!("gmObjects"in f))throw"gmObjects attribute required";if(!("gmGetLatLng"in f))throw"gmGetLatLng attribute required";var l={};angular.forEach(f,function(b,j){if(0===j.lastIndexOf("gmOn",0)){var k=
angular.lowercase(j.substring(4)),c=a(b);l[k]=c}});var j=function(a){var j={};angular.forEach(a,function(a){var m=b.gmGetLatLng({object:a}),c=d(m);if(null!=c){var p=b.gmGetMarkerOptions({object:a}),h=c.toUrlValue(k.precision);if(j[h]=a,!k.hasMarker(m.lat,m.lng)){h={};angular.extend(h,p,{position:c});k.addMarker(h);var f=k.getMarker(m.lat,m.lng);angular.forEach(l,function(j,m){k.addListener(f,m,function(){e(function(){j(b.$parent.$parent,{object:a,marker:f})})})})}}});var c=[];k.forEachMarker(function(a){a.getPosition().toUrlValue(k.precision)in
j||c.push(a)});angular.forEach(c,function(a){a=a.getPosition();k.removeMarker(a.lat(),a.lng())})};b.$watch("gmObjects().length",function(a,c){null!=a&&a!==c&&j(b.gmObjects())});b.$watch("gmObjects()",function(a,c){null!=a&&a!==c&&j(b.gmObjects())});b.$watch("gmEvent()",function(a,b){if(null!=a&&a!==b){var j=a.event,c=a.location,c=k.getMarker(c.lat(),c.lng());null!=c&&e(angular.bind(this,k.trigger,c,j))}});e(angular.bind(null,j,b.gmObjects()))}}}])})();
(function(){angular.module("AngularGM").factory("angulargmContainer",["$q",function(b){var a={},e={};return{addMap:function(b,d){if(!(d instanceof google.maps.Map))throw"map not a google.maps.Map: "+d;if(b in a)throw"already contain map with id "+b;a[b]=d;b in e&&e[b].resolve(d)},getMap:function(b){return a[b]},getMapPromise:function(a){var d=e[a]||b.defer();return e[a]=d,d.promise},removeMap:function(b){b in a&&delete a[b];b in e&&delete e[b]},clear:function(){a={};e={}}}}])})();
(function(){angular.module("AngularGM").factory("angulargmUtils",[function(){function b(a,b){var c;if(a instanceof google.maps.LatLng&&b instanceof google.maps.LatLng){c=a.lat();var d=b.lat();if(c=1E-6>Math.abs(c-d))c=a.lng(),d=b.lng(),c=1E-6>Math.abs(c-d)}else c=!1;return c}return{latLngEqual:b,boundsEqual:function(a,e){if(!(a instanceof google.maps.LatLngBounds&&e instanceof google.maps.LatLngBounds))return!1;var c=a.getSouthWest(),d=e.getSouthWest(),g=a.getNorthEast(),h=e.getNorthEast();return b(c,
d)&&b(g,h)},latLngToObj:function(a){if(!(a instanceof google.maps.LatLng))throw"latLng not a google.maps.LatLng";return{lat:a.lat(),lng:a.lng()}},objToLatLng:function(a){if(null!=a){var b=a.lat;a=a.lng;if(!(null==b||null==a||isNaN(b)||isNaN(a)))return new google.maps.LatLng(b,a)}return null},hasNaN:function(a){if(!(a instanceof google.maps.LatLng))throw"latLng must be a google.maps.LatLng";var b=null==a.lat()||null==a.lng();a=isNaN(a.lat())||isNaN(a.lng());return b||a}}}])})();
(function(){angular.module("AngularGM").controller("angulargmMapController",["$scope","$element","angulargmUtils","angulargmDefaults","angulargmContainer",function(b,a,e,c,d){var g=e.latLngEqual,h=e.boundsEqual,f=e.hasNaN;this._getConfig=function(a,b){var j={};return angular.extend(j,b.mapOptions,a.gmMapOptions()),j};this._createMap=function(a,b,j,m){var c=m.getMap(a);if(c)throw"A map with id "+a+" already exists. You must use different ids for each instance of the angulargm directive.";return c=
new google.maps.Map(b[0],j),m.addMap(a,c),c};this._initDragListeners=function(){var a=this;this.addMapListener("dragstart",function(){a.dragging=!0});this.addMapListener("idle",function(){a.dragging=!1});this.addMapListener("drag",function(){a.dragging=!0})};this._destroy=function(a){d.removeMap(a)};this.addMapListener=function(a,b){google.maps.event.addListener(this._map,a,b)};this.addMapListenerOnce=function(a,b){google.maps.event.addListenerOnce(this._map,a,b)};this.addListener=function(a,b,j){google.maps.event.addListener(a,
b,j)};this.addListenerOnce=function(a,b,j){google.maps.event.addListenerOnce(a,b,j)};this.mapTrigger=function(a){google.maps.event.trigger(this._map,a)};this.trigger=function(a,b){google.maps.event.trigger(a,b)};this.addMarker=function(a){var b={};if(angular.extend(b,a),!(b.position instanceof google.maps.LatLng))throw"markerOptions did not contain a position";a=new google.maps.Marker(b);b=a.getPosition();if(this.hasMarker(b.lat(),b.lng()))return!1;b=b.toUrlValue(this.precision);return this._markers[b]=
a,a.setMap(this._map),!0};this.hasMarker=function(a,b){return this.getMarker(a,b)instanceof google.maps.Marker};this.getMarker=function(a,b){if(null==a||null==b)throw"lat or lng was null";var j=(new google.maps.LatLng(a,b)).toUrlValue(this.precision);return j in this._markers?this._markers[j]:null};this.removeMarker=function(a,b){if(null==a||null==b)throw"lat or lng was null";var j=!1,m=(new google.maps.LatLng(a,b)).toUrlValue(this.precision),c=this._markers[m];return c&&(c.setMap(null),j=!0),this._markers[m]=
null,delete this._markers[m],j};this.fitToMarkers=function(){var a=new google.maps.LatLngBounds;this.forEachMarker(function(b){a.extend(b.getPosition())});this.bounds=a};this.forEachMarker=function(a){if(null==a)throw"fn was null or undefined";angular.forEach(this._markers,function(b){null!=b&&a(b)})};angular.bind(this,function(a,b){var j=a.gmMapId();if(!j)throw"angulargm must have non-empty gmMapId attribute";var m=b.find("[id]");m.attr("id",j);var e=this._getConfig(a,c);this._map=this._createMap(j,
m,e,d);this._markers={};this.dragging=!1;Object.defineProperties(this,{precision:{value:3,writeable:!1},center:{configurable:!0,get:function(){return this._map.getCenter()},set:function(a){if(f(a))throw"center contains null or NaN";!g(this.center,a)&&this._map.panTo(a)}},zoom:{configurable:!0,get:function(){return this._map.getZoom()},set:function(a){if(null==a||isNaN(a))throw"zoom was null or NaN";this.zoom!==a&&this._map.setZoom(a)}},bounds:{configurable:!0,get:function(){return this._map.getBounds()},
set:function(a){if(f(a.getSouthWest())||f(a.getNorthEast()))throw"bounds contains null or NaN";!h(this.bounds,a)&&this._map.fitBounds(a)}}});this._initDragListeners();a.$on("$destroy",angular.bind(this,this._destroy,j))})(b,a)}])})();/*
 MIT License, http://www.opensource.org/licenses/MIT
*/
(function(){angular.module("AngularGM",[]).value("angulargmDefaults",{mapOptions:{zoom:8,center:new google.maps.LatLng(46,-120),mapTypeId:google.maps.MapTypeId.ROADMAP}})})();
(function(){angular.module("AngularGM").directive("gmMap",["$timeout",function(b){return{restrict:"AE",priority:100,template:'<div><div id="" style="width:100%;height:100%;"></div><div ng-transclude></div></div>',transclude:!0,replace:!0,scope:{gmCenter:"=",gmZoom:"=",gmBounds:"=",gmMapOptions:"&",gmMapId:"&"},controller:"angulargmMapController",link:function(a,e,c,d){if(angular.isDefined(a.gmCenter)||(a.center={}),angular.isDefined(a.gmBounds)||(a.bounds={}),!angular.isDefined(a.gmMapId))throw"angulargm must have non-empty gmMapId attribute";
var g=!1,h=!1,f=!1;c.hasOwnProperty("gmCenter")&&(g=!0);c.hasOwnProperty("gmZoom")&&(h=!0);c.hasOwnProperty("gmBounds")&&(f=!0);e=function(){b(function(){(g||h||f)&&a.$apply(function(){if(g&&(a.gmCenter=d.center),h&&(a.gmZoom=d.zoom),f){var b=d.bounds;b&&(a.gmBounds=b)}})})};d.addMapListener("drag",e);d.addMapListener("zoom_changed",e);d.addMapListener("center_changed",e);d.addMapListener("bounds_changed",e);g&&a.$watch("gmCenter",function(a,b){a!==b&&!d.dragging&&a&&(d.center=a)},!0);h&&a.$watch("gmZoom",
function(a,b){null!=a&&!isNaN(a)&&a!==b&&(d.zoom=a)});f&&a.$watch("gmBounds",function(a,b){a!==b&&!d.dragging&&a&&(d.bounds=a)})}}}])})();
(function(){angular.module("AngularGM").directive("gmMarkers",["$log","$parse","$timeout","angulargmUtils",function(b,a,e,c){c.latLngEqual;var d=c.objToLatLng;return{restrict:"AE",priority:100,scope:{gmObjects:"&",gmGetLatLng:"&",gmGetMarkerOptions:"&",gmEvents:"&"},require:"^gmMap",link:function(b,c,f,k){if(!("gmObjects"in f))throw"gmObjects attribute required";if(!("gmGetLatLng"in f))throw"gmGetLatLng attribute required";var l={};angular.forEach(f,function(b,j){if(0===j.lastIndexOf("gmOn",0)){var c=
angular.lowercase(j.substring(4)),d=a(b);l[c]=d}});var j=function(a){var j={};angular.forEach(a,function(a){var c=b.gmGetLatLng({object:a}),m=d(c);if(null!=m){var h=b.gmGetMarkerOptions({object:a}),p=m.toUrlValue(k.precision);if(j[p]=a,!k.hasMarker(c.lat,c.lng)){p={};angular.extend(p,h,{position:m});k.addMarker(p);var f=k.getMarker(c.lat,c.lng);angular.forEach(l,function(j,c){k.addListener(f,c,function(){e(function(){j(b.$parent.$parent,{object:a,marker:f})})})})}}});var c=[];k.forEachMarker(function(a){a.getPosition().toUrlValue(k.precision)in
j||c.push(a)});angular.forEach(c,function(a){a=a.getPosition();k.removeMarker(a.lat(),a.lng())});b.$emit("gmMarkersUpdated",f.gmObjects)};b.$watch("gmObjects().length",function(a,c){null!=a&&a!==c&&j(b.gmObjects())});b.$watch("gmObjects()",function(a,c){null!=a&&a!==c&&j(b.gmObjects())});b.$watch("gmEvents()",function(a,b){null!=a&&a!==b&&angular.forEach(a,function(a){var b=a.event;angular.forEach(a.locations,function(a){a=k.getMarker(a.lat(),a.lng());null!=a&&e(angular.bind(this,k.trigger,a,b))})})});
b.$on("gmMarkersRedraw",function(a,c){c===f.gmObjects&&(j(),j(b.gmObjects()))});e(angular.bind(null,j,b.gmObjects()))}}}])})();
(function(){angular.module("AngularGM").factory("angulargmContainer",["$q",function(b){var a={},e={};return{addMap:function(b,d){if(!(d instanceof google.maps.Map))throw"map not a google.maps.Map: "+d;if(b in a)throw"already contain map with id "+b;a[b]=d;b in e&&e[b].resolve(d)},getMap:function(b){return a[b]},getMapPromise:function(a){var d=e[a]||b.defer();return e[a]=d,d.promise},removeMap:function(b){b in a&&delete a[b];b in e&&delete e[b]},clear:function(){a={};e={}}}}])})();
(function(){angular.module("AngularGM").factory("angulargmUtils",[function(){function b(a,b){var c;if(a instanceof google.maps.LatLng&&b instanceof google.maps.LatLng){c=a.lat();var d=b.lat();if(c=1E-6>Math.abs(c-d))c=a.lng(),d=b.lng(),c=1E-6>Math.abs(c-d)}else c=!1;return c}return{latLngEqual:b,boundsEqual:function(a,e){if(!(a instanceof google.maps.LatLngBounds&&e instanceof google.maps.LatLngBounds))return!1;var c=a.getSouthWest(),d=e.getSouthWest(),g=a.getNorthEast(),h=e.getNorthEast();return b(c,
d)&&b(g,h)},latLngToObj:function(a){if(!(a instanceof google.maps.LatLng))throw"latLng not a google.maps.LatLng";return{lat:a.lat(),lng:a.lng()}},objToLatLng:function(a){if(null!=a){var b=a.lat;a=a.lng;if(!(null==b||null==a||isNaN(b)||isNaN(a)))return new google.maps.LatLng(b,a)}return null},hasNaN:function(a){if(!(a instanceof google.maps.LatLng))throw"latLng must be a google.maps.LatLng";var b=null==a.lat()||null==a.lng();a=isNaN(a.lat())||isNaN(a.lng());return b||a}}}])})();
(function(){angular.module("AngularGM").controller("angulargmMapController",["$scope","$element","angulargmUtils","angulargmDefaults","angulargmContainer",function(b,a,e,c,d){var g=e.latLngEqual,h=e.boundsEqual,f=e.hasNaN;this._getConfig=function(a,b){var j={};return angular.extend(j,b.mapOptions,a.gmMapOptions()),j};this._createMap=function(a,b,j,c){var d=c.getMap(a);if(d)throw"A map with id "+a+" already exists. You must use different ids for each instance of the angulargm directive.";return d=
new google.maps.Map(b[0],j),c.addMap(a,d),d};this._initDragListeners=function(){var a=this;this.addMapListener("dragstart",function(){a.dragging=!0});this.addMapListener("idle",function(){a.dragging=!1});this.addMapListener("drag",function(){a.dragging=!0})};this._destroy=function(a){d.removeMap(a)};this.addMapListener=function(a,b){google.maps.event.addListener(this._map,a,b)};this.addMapListenerOnce=function(a,b){google.maps.event.addListenerOnce(this._map,a,b)};this.addListener=function(a,b,j){google.maps.event.addListener(a,
b,j)};this.addListenerOnce=function(a,b,j){google.maps.event.addListenerOnce(a,b,j)};this.mapTrigger=function(a){google.maps.event.trigger(this._map,a)};this.trigger=function(a,b){google.maps.event.trigger(a,b)};this.addMarker=function(a){var b={};if(angular.extend(b,a),!(b.position instanceof google.maps.LatLng))throw"markerOptions did not contain a position";a=new google.maps.Marker(b);b=a.getPosition();if(this.hasMarker(b.lat(),b.lng()))return!1;b=b.toUrlValue(this.precision);return this._markers[b]=
a,a.setMap(this._map),!0};this.hasMarker=function(a,b){return this.getMarker(a,b)instanceof google.maps.Marker};this.getMarker=function(a,b){if(null==a||null==b)throw"lat or lng was null";var j=(new google.maps.LatLng(a,b)).toUrlValue(this.precision);return j in this._markers?this._markers[j]:null};this.removeMarker=function(a,b){if(null==a||null==b)throw"lat or lng was null";var j=!1,c=(new google.maps.LatLng(a,b)).toUrlValue(this.precision),d=this._markers[c];return d&&(d.setMap(null),j=!0),this._markers[c]=
null,delete this._markers[c],j};this.fitToMarkers=function(){var a=new google.maps.LatLngBounds;this.forEachMarker(function(b){a.extend(b.getPosition())});this.bounds=a};this.forEachMarker=function(a){if(null==a)throw"fn was null or undefined";angular.forEach(this._markers,function(b){null!=b&&a(b)})};angular.bind(this,function(a,b){var j=a.gmMapId();if(!j)throw"angulargm must have non-empty gmMapId attribute";var m=b.find("[id]");m.attr("id",j);var e=this._getConfig(a,c);this._map=this._createMap(j,
m,e,d);this._markers={};this.dragging=!1;Object.defineProperties(this,{precision:{value:3,writeable:!1},center:{configurable:!0,get:function(){return this._map.getCenter()},set:function(a){if(f(a))throw"center contains null or NaN";!g(this.center,a)&&this._map.panTo(a)}},zoom:{configurable:!0,get:function(){return this._map.getZoom()},set:function(a){if(null==a||isNaN(a))throw"zoom was null or NaN";this.zoom!==a&&this._map.setZoom(a)}},bounds:{configurable:!0,get:function(){return this._map.getBounds()},
set:function(a){if(f(a.getSouthWest())||f(a.getNorthEast()))throw"bounds contains null or NaN";!h(this.bounds,a)&&this._map.fitBounds(a)}}});this._initDragListeners();a.$on("$destroy",angular.bind(this,this._destroy,j))})(b,a)}])})();(function(){function b(a,b){var c=this,d=new google.maps.OverlayView;d.onAdd=function(){c.init_(a,b)};d.draw=function(){};d.onRemove=function(){};d.setMap(a);this.prjov_=d}var a=function(a){switch(a){case "thin":a="2px";break;case "medium":a="4px";break;case "thick":a="6px";break}return a},e=function(b){var c,d={};if(document.defaultView&&document.defaultView.getComputedStyle){if(c=b.ownerDocument.defaultView.getComputedStyle(b,""))return d.top=parseInt(c.borderTopWidth,10)||0,d.bottom=parseInt(c.borderBottomWidth,
10)||0,d.left=parseInt(c.borderLeftWidth,10)||0,d.right=parseInt(c.borderRightWidth,10)||0,d}else if(document.documentElement.currentStyle&&b.currentStyle)return d.top=parseInt(a(b.currentStyle.borderTopWidth),10)||0,d.bottom=parseInt(a(b.currentStyle.borderBottomWidth),10)||0,d.left=parseInt(a(b.currentStyle.borderLeftWidth),10)||0,d.right=parseInt(a(b.currentStyle.borderRightWidth),10)||0,d;d.top=parseInt(b.style["border-top-width"],10)||0;d.bottom=parseInt(b.style["border-bottom-width"],10)||0;
d.left=parseInt(b.style["border-left-width"],10)||0;d.right=parseInt(b.style["border-right-width"],10)||0;return d},c=0,d=0,g=function(){c="undefined"!==typeof document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft;d="undefined"!==typeof document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop};g();var h=function(a){var b=0,e=0;a=a||window.event;"undefined"!==typeof a.pageX?(b=a.pageX,e=a.pageY):"undefined"!==typeof a.clientX&&
(b=a.clientX+c,e=a.clientY+d);return{left:b,top:e}},f=function(a){var b=a.offsetLeft,c=a.offsetTop;for(a=a.offsetParent;null!==a;){a!==document.body&&a!==document.documentElement&&(b-=a.scrollLeft,c-=a.scrollTop);var d=a,e=d.offsetLeft,h=d.offsetTop;if(!e&&!h&&window.getComputedStyle&&(d=document.defaultView.getComputedStyle(d,null).MozTransform||document.defaultView.getComputedStyle(d,null).WebkitTransform)&&"string"===typeof d)d=d.split(","),e+=parseInt(d[4],10)||0,h+=parseInt(d[5],10)||0;b+=e;
c+=h;a=a.offsetParent}return{left:b,top:c}},k=function(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},l=function(a,b){"undefined"!==typeof b&&(a.style.opacity=b);"undefined"!==typeof a.style.opacity&&""!==a.style.opacity&&(a.style.filter="alpha(opacity="+100*a.style.opacity+")")};b.prototype.init_=function(a,b){var c,d=this;this.map_=a;b=b||{};this.key_=b.key||"shift";this.key_=this.key_.toLowerCase();this.borderWidths_=e(this.map_.getDiv());this.veilDiv_=[];for(c=0;4>c;c++)this.veilDiv_[c]=
document.createElement("div"),this.veilDiv_[c].onselectstart=function(){return!1},k(this.veilDiv_[c].style,{backgroundColor:"gray",opacity:0.25,cursor:"crosshair"}),k(this.veilDiv_[c].style,b.paneStyle),k(this.veilDiv_[c].style,b.veilStyle),k(this.veilDiv_[c].style,{position:"absolute",overflow:"hidden",display:"none"}),"shift"===this.key_&&(this.veilDiv_[c].style.MozUserSelect="none"),l(this.veilDiv_[c]),"transparent"===this.veilDiv_[c].style.backgroundColor&&(this.veilDiv_[c].style.backgroundColor=
"white",l(this.veilDiv_[c],0)),this.map_.getDiv().appendChild(this.veilDiv_[c]);this.noZoom_=b.noZoom||!1;this.visualEnabled_=b.visualEnabled||!1;this.visualClass_=b.visualClass||"";this.visualPosition_=b.visualPosition||google.maps.ControlPosition.LEFT_TOP;this.visualPositionOffset_=b.visualPositionOffset||new google.maps.Size(35,0);this.visualPositionIndex_=b.visualPositionIndex||null;this.visualSprite_=b.visualSprite||"http"+("https:"===document.location.protocol?"s":"")+"://maps.gstatic.com/mapfiles/ftr/controls/dragzoom_btn.png";
this.visualSize_=b.visualSize||new google.maps.Size(20,20);this.visualTips_=b.visualTips||{};this.visualTips_.off=this.visualTips_.off||"Turn on drag zoom mode";this.visualTips_.on=this.visualTips_.on||"Turn off drag zoom mode";this.boxDiv_=document.createElement("div");k(this.boxDiv_.style,{border:"4px solid #736AFF"});k(this.boxDiv_.style,b.boxStyle);k(this.boxDiv_.style,{position:"absolute",display:"none"});l(this.boxDiv_);this.map_.getDiv().appendChild(this.boxDiv_);this.boxBorderWidths_=e(this.boxDiv_);
this.listeners_=[google.maps.event.addDomListener(document,"keydown",function(a){d.onKeyDown_(a)}),google.maps.event.addDomListener(document,"keyup",function(a){d.onKeyUp_(a)}),google.maps.event.addDomListener(this.veilDiv_[0],"mousedown",function(a){d.onMouseDown_(a)}),google.maps.event.addDomListener(this.veilDiv_[1],"mousedown",function(a){d.onMouseDown_(a)}),google.maps.event.addDomListener(this.veilDiv_[2],"mousedown",function(a){d.onMouseDown_(a)}),google.maps.event.addDomListener(this.veilDiv_[3],
"mousedown",function(a){d.onMouseDown_(a)}),google.maps.event.addDomListener(document,"mousedown",function(a){d.onMouseDownDocument_(a)}),google.maps.event.addDomListener(document,"mousemove",function(a){d.onMouseMove_(a)}),google.maps.event.addDomListener(document,"mouseup",function(a){d.onMouseUp_(a)}),google.maps.event.addDomListener(window,"scroll",g)];this.dragging_=this.mouseDown_=this.hotKeyDown_=!1;this.mapPosn_=this.mousePosn_=this.mapHeight_=this.mapWidth_=this.endPt_=this.startPt_=null;
this.visualEnabled_&&(this.buttonDiv_=this.initControl_(this.visualPositionOffset_),null!==this.visualPositionIndex_&&(this.buttonDiv_.index=this.visualPositionIndex_),this.map_.controls[this.visualPosition_].push(this.buttonDiv_),this.controlIndex_=this.map_.controls[this.visualPosition_].length-1)};b.prototype.initControl_=function(a){var b,c,d=this;b=document.createElement("div");b.className=this.visualClass_;b.style.position="relative";b.style.overflow="hidden";b.style.height=this.visualSize_.height+
"px";b.style.width=this.visualSize_.width+"px";b.title=this.visualTips_.off;c=document.createElement("img");c.src=this.visualSprite_;c.style.position="absolute";c.style.left=-(2*this.visualSize_.width)+"px";c.style.top="0px";b.appendChild(c);b.onclick=function(a){d.hotKeyDown_=!d.hotKeyDown_;d.hotKeyDown_?(d.buttonDiv_.firstChild.style.left=-(0*d.visualSize_.width)+"px",d.buttonDiv_.title=d.visualTips_.on,d.activatedByControl_=!0,google.maps.event.trigger(d,"activate")):(d.buttonDiv_.firstChild.style.left=
-(2*d.visualSize_.width)+"px",d.buttonDiv_.title=d.visualTips_.off,google.maps.event.trigger(d,"deactivate"));d.onMouseMove_(a)};b.onmouseover=function(){d.buttonDiv_.firstChild.style.left=-(1*d.visualSize_.width)+"px"};b.onmouseout=function(){d.hotKeyDown_?(d.buttonDiv_.firstChild.style.left=-(0*d.visualSize_.width)+"px",d.buttonDiv_.title=d.visualTips_.on):(d.buttonDiv_.firstChild.style.left=-(2*d.visualSize_.width)+"px",d.buttonDiv_.title=d.visualTips_.off)};b.ondragstart=function(){return!1};
k(b.style,{cursor:"pointer",marginTop:a.height+"px",marginLeft:a.width+"px"});return b};b.prototype.isHotKeyDown_=function(a){var b;a=a||window.event;b=a.shiftKey&&"shift"===this.key_||a.altKey&&"alt"===this.key_||a.ctrlKey&&"ctrl"===this.key_;if(!b)switch(a.keyCode){case 16:"shift"===this.key_&&(b=!0);break;case 17:"ctrl"===this.key_&&(b=!0);break;case 18:"alt"===this.key_&&(b=!0)}return b};b.prototype.isMouseOnMap_=function(){var a=this.mousePosn_;if(a){var b=this.mapPosn_,d=this.map_.getDiv();
return a.left>b.left&&a.left<b.left+d.offsetWidth&&a.top>b.top&&a.top<b.top+d.offsetHeight}return!1};b.prototype.setVeilVisibility_=function(){var a;if(this.map_&&this.hotKeyDown_&&this.isMouseOnMap_()){a=this.map_.getDiv();this.mapWidth_=a.offsetWidth-(this.borderWidths_.left+this.borderWidths_.right);this.mapHeight_=a.offsetHeight-(this.borderWidths_.top+this.borderWidths_.bottom);if(this.activatedByControl_){a=parseInt(this.buttonDiv_.style.left,10)+this.visualPositionOffset_.width;var b=parseInt(this.buttonDiv_.style.top,
10)+this.visualPositionOffset_.height,d=this.visualSize_.width,c=this.visualSize_.height;this.veilDiv_[0].style.top="0px";this.veilDiv_[0].style.left="0px";this.veilDiv_[0].style.width=a+"px";this.veilDiv_[0].style.height=this.mapHeight_+"px";this.veilDiv_[1].style.top="0px";this.veilDiv_[1].style.left=a+d+"px";this.veilDiv_[1].style.width=this.mapWidth_-(a+d)+"px";this.veilDiv_[1].style.height=this.mapHeight_+"px";this.veilDiv_[2].style.top="0px";this.veilDiv_[2].style.left=a+"px";this.veilDiv_[2].style.width=
d+"px";this.veilDiv_[2].style.height=b+"px";this.veilDiv_[3].style.top=b+c+"px";this.veilDiv_[3].style.left=a+"px";this.veilDiv_[3].style.width=d+"px";this.veilDiv_[3].style.height=this.mapHeight_-(b+c)+"px"}else{this.veilDiv_[0].style.left="0px";this.veilDiv_[0].style.top="0px";this.veilDiv_[0].style.width=this.mapWidth_+"px";this.veilDiv_[0].style.height=this.mapHeight_+"px";for(a=1;a<this.veilDiv_.length;a++)this.veilDiv_[a].style.width="0px",this.veilDiv_[a].style.height="0px"}for(a=0;a<this.veilDiv_.length;a++)this.veilDiv_[a].style.display=
"block"}else for(a=0;a<this.veilDiv_.length;a++)this.veilDiv_[a].style.display="none"};b.prototype.onKeyDown_=function(a){this.map_&&(!this.hotKeyDown_&&this.isHotKeyDown_(a))&&(this.mapPosn_=f(this.map_.getDiv()),this.hotKeyDown_=!0,this.activatedByControl_=!1,this.setVeilVisibility_(),google.maps.event.trigger(this,"activate"))};b.prototype.getMousePoint_=function(a){a=h(a);var b=new google.maps.Point;b.x=a.left-this.mapPosn_.left-this.borderWidths_.left;b.y=a.top-this.mapPosn_.top-this.borderWidths_.top;
b.x=Math.min(b.x,this.mapWidth_);b.y=Math.min(b.y,this.mapHeight_);b.x=Math.max(b.x,0);b.y=Math.max(b.y,0);return b};b.prototype.onMouseDown_=function(a){this.map_&&this.hotKeyDown_&&(this.mapPosn_=f(this.map_.getDiv()),this.dragging_=!0,this.startPt_=this.endPt_=this.getMousePoint_(a),this.boxDiv_.style.width=this.boxDiv_.style.height="0px",a=this.prjov_.getProjection().fromContainerPixelToLatLng(this.startPt_),google.maps.event.trigger(this,"dragstart",a))};b.prototype.onMouseDownDocument_=function(){this.mouseDown_=
!0};b.prototype.onMouseMove_=function(a){this.mousePosn_=h(a);if(this.dragging_){this.endPt_=this.getMousePoint_(a);a=Math.min(this.startPt_.x,this.endPt_.x);var b=Math.min(this.startPt_.y,this.endPt_.y),d=Math.abs(this.startPt_.x-this.endPt_.x),c=Math.abs(this.startPt_.y-this.endPt_.y),e=Math.max(0,d-(this.boxBorderWidths_.left+this.boxBorderWidths_.right)),g=Math.max(0,c-(this.boxBorderWidths_.top+this.boxBorderWidths_.bottom));this.veilDiv_[0].style.top="0px";this.veilDiv_[0].style.left="0px";
this.veilDiv_[0].style.width=a+"px";this.veilDiv_[0].style.height=this.mapHeight_+"px";this.veilDiv_[1].style.top="0px";this.veilDiv_[1].style.left=a+d+"px";this.veilDiv_[1].style.width=this.mapWidth_-(a+d)+"px";this.veilDiv_[1].style.height=this.mapHeight_+"px";this.veilDiv_[2].style.top="0px";this.veilDiv_[2].style.left=a+"px";this.veilDiv_[2].style.width=d+"px";this.veilDiv_[2].style.height=b+"px";this.veilDiv_[3].style.top=b+c+"px";this.veilDiv_[3].style.left=a+"px";this.veilDiv_[3].style.width=
d+"px";this.veilDiv_[3].style.height=this.mapHeight_-(b+c)+"px";this.boxDiv_.style.top=b+"px";this.boxDiv_.style.left=a+"px";this.boxDiv_.style.width=e+"px";this.boxDiv_.style.height=g+"px";this.boxDiv_.style.display="block";google.maps.event.trigger(this,"drag",new google.maps.Point(a,b+c),new google.maps.Point(a+d,b),this.prjov_.getProjection())}else this.mouseDown_||(this.mapPosn_=f(this.map_.getDiv()),this.setVeilVisibility_())};b.prototype.onMouseUp_=function(a){var b,d=this;this.mouseDown_=
!1;if(this.dragging_)if(this.getMousePoint_(a).x===this.startPt_.x&&this.getMousePoint_(a).y===this.startPt_.y)this.onKeyUp_(a);else{var c=Math.min(this.startPt_.x,this.endPt_.x),e=Math.min(this.startPt_.y,this.endPt_.y);b=Math.abs(this.startPt_.x-this.endPt_.x);var h=Math.abs(this.startPt_.y-this.endPt_.y),c=c+this.borderWidths_.left,e=e+this.borderWidths_.top,f=this.prjov_.getProjection(),h=f.fromContainerPixelToLatLng(new google.maps.Point(c,e+h)),e=f.fromContainerPixelToLatLng(new google.maps.Point(c+
b,e)),c=new google.maps.LatLngBounds(h,e);this.noZoom_?this.boxDiv_.style.display="none":(b=this.map_.getZoom(),this.map_.fitBounds(c),this.map_.getZoom()<b&&this.map_.setZoom(b),h=f.fromLatLngToContainerPixel(h),f=f.fromLatLngToContainerPixel(e),h.x-=this.borderWidths_.left,h.y-=this.borderWidths_.top,f.x-=this.borderWidths_.left,f.y-=this.borderWidths_.top,this.boxDiv_.style.left=h.x+"px",this.boxDiv_.style.top=f.y+"px",this.boxDiv_.style.width=Math.abs(f.x-h.x)-(this.boxBorderWidths_.left+this.boxBorderWidths_.right)+
"px",this.boxDiv_.style.height=Math.abs(f.y-h.y)-(this.boxBorderWidths_.top+this.boxBorderWidths_.bottom)+"px",setTimeout(function(){d.boxDiv_.style.display="none"},1E3));this.dragging_=!1;this.onMouseMove_(a);google.maps.event.trigger(this,"dragend",c);if(!this.isHotKeyDown_(a))this.onKeyUp_(a)}};b.prototype.onKeyUp_=function(){var a,b,d,c,e;b=null;if(this.map_&&this.hotKeyDown_){this.hotKeyDown_=!1;this.dragging_&&(this.boxDiv_.style.display="none",this.dragging_=!1,a=Math.min(this.startPt_.x,this.endPt_.x),
b=Math.min(this.startPt_.y,this.endPt_.y),d=Math.abs(this.startPt_.x-this.endPt_.x),c=Math.abs(this.startPt_.y-this.endPt_.y),e=this.prjov_.getProjection(),c=e.fromContainerPixelToLatLng(new google.maps.Point(a,b+c)),a=e.fromContainerPixelToLatLng(new google.maps.Point(a+d,b)),b=new google.maps.LatLngBounds(c,a));for(a=0;a<this.veilDiv_.length;a++)this.veilDiv_[a].style.display="none";this.visualEnabled_&&(this.buttonDiv_.firstChild.style.left=-(2*this.visualSize_.width)+"px",this.buttonDiv_.title=
this.visualTips_.off,this.buttonDiv_.style.display="");google.maps.event.trigger(this,"deactivate",b)}};google.maps.Map.prototype.enableKeyDragZoom=function(a){this.dragZoom_=new b(this,a)};google.maps.Map.prototype.disableKeyDragZoom=function(){var a,b=this.dragZoom_;if(b){for(a=0;a<b.listeners_.length;++a)google.maps.event.removeListener(b.listeners_[a]);this.getDiv().removeChild(b.boxDiv_);for(a=0;a<b.veilDiv_.length;a++)this.getDiv().removeChild(b.veilDiv_[a]);b.visualEnabled_&&this.controls[b.visualPosition_].removeAt(b.controlIndex_);
b.prjov_.setMap(null);this.dragZoom_=null}};google.maps.Map.prototype.keyDragZoomEnabled=function(){return null!==this.dragZoom_};google.maps.Map.prototype.getDragZoomObject=function(){return this.dragZoom_}})();angular.module("ui.bootstrap","ui.bootstrap.transition ui.bootstrap.collapse ui.bootstrap.accordion ui.bootstrap.alert ui.bootstrap.buttons ui.bootstrap.carousel ui.bootstrap.dialog ui.bootstrap.dropdownToggle ui.bootstrap.modal ui.bootstrap.pagination ui.bootstrap.tooltip ui.bootstrap.popover ui.bootstrap.progressbar ui.bootstrap.tabs ui.bootstrap.typeahead".split(" "));
angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(b,a,e){function c(a){for(var b in a)if(void 0!==g.style[b])return a[b]}var d=function(c,f,g){g=g||{};var l=b.defer(),j=d[g.animation?"animationEndEventName":"transitionEndEventName"],m=function(){e.$apply(function(){c.unbind(j,m);l.resolve(c)})};j&&c.bind(j,m);a(function(){angular.isString(f)?c.addClass(f):angular.isFunction(f)?f(c):angular.isObject(f)&&c.css(f);j||l.resolve(c)});l.promise.cancel=
function(){j&&c.unbind(j,m);l.reject("Transition cancelled")};return l.promise},g=document.createElement("trans");d.transitionEndEventName=c({WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"});d.animationEndEventName=c({WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"});return d}]);
angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(b){var a=function(a,b,d){b.removeClass("collapse");b.css({height:d});b.addClass("collapse")};return{link:function(e,c,d){var g,h=!0;e.$watch(function(){return c[0].scrollHeight},function(){0!==c[0].scrollHeight&&(g||(h?a(e,c,c[0].scrollHeight+"px"):a(e,c,"auto")))});e.$watch(d.collapse,function(b){b?(g=!0,h?(h=!1,a(e,c,0)):(a(e,c,c[0].scrollHeight+"px"),k({height:"0"}))):(h?(h=!1,g||a(e,
c,"auto")):k({height:c[0].scrollHeight+"px"}).then(function(){g||a(e,c,"auto")}),g=!1)});var f,k=function(a){f&&f.cancel();f=b(c,a);f.then(function(){f=void 0},function(){f=void 0});return f}}}}]);
angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(b,a,e){this.groups=[];this.closeOthers=function(c){(angular.isDefined(a.closeOthers)?b.$eval(a.closeOthers):e.closeOthers)&&angular.forEach(this.groups,function(a){a!==c&&(a.isOpen=!1)})};this.addGroup=function(a){var b=this;this.groups.push(a);a.$on("$destroy",function(){b.removeGroup(a)})};this.removeGroup=
function(a){-1!==this.groups.indexOf(a)&&this.groups.splice(this.groups.indexOf(a),1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",["$parse","$transition","$timeout",function(b){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@"},controller:["$scope",function(){this.setHeading=
function(a){this.heading=a}}],link:function(a,e,c,d){var g,h;d.addGroup(a);a.isOpen=!1;c.isOpen&&(g=b(c.isOpen),h=g.assign,a.$watch(function(){return g(a.$parent)},function(b){a.isOpen=b}),a.isOpen=g?g(a.$parent):!1);a.$watch("isOpen",function(b){b&&d.closeOthers(a);h&&h(a.$parent,b)})}}}]).directive("accordionHeading",function(){return{restrict:"E",transclude:!0,template:"",replace:!0,require:"^accordionGroup",compile:function(b,a,e){return function(a,b,g,h){h.setHeading(e(a,function(){}))}}}}).directive("accordionTransclude",
function(){return{require:"^accordionGroup",link:function(b,a,e,c){b.$watch(function(){return c[e.accordionTransclude]},function(b){b&&(a.html(""),a.append(b))})}}});angular.module("ui.bootstrap.alert",[]).directive("alert",function(){return{restrict:"EA",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"=",close:"&"},link:function(b,a,e){b.closeable="close"in e}}});
angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).directive("btnRadio",["buttonConfig",function(b){var a=b.activeClass||"active",e=b.toggleEvent||"click";return{require:"ngModel",link:function(b,d,g,h){var f=b.$eval(g.btnRadio);b.$watch(function(){return h.$modelValue},function(b){angular.equals(b,f)?d.addClass(a):d.removeClass(a)});d.bind(e,function(){d.hasClass(a)||b.$apply(function(){h.$setViewValue(f)})})}}}]).directive("btnCheckbox",
["buttonConfig",function(b){var a=b.activeClass||"active",e=b.toggleEvent||"click";return{require:"ngModel",link:function(b,d,g,h){var f=b.$eval(g.btnCheckboxTrue),k=b.$eval(g.btnCheckboxFalse),f=angular.isDefined(f)?f:!0,k=angular.isDefined(k)?k:!1;b.$watch(function(){return h.$modelValue},function(b){angular.equals(b,f)?d.addClass(a):d.removeClass(a)});d.bind(e,function(){b.$apply(function(){h.$setViewValue(d.hasClass(a)?k:f)})})}}}]);
angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition","$q",function(b,a,e){function c(){function d(){k?(b.next(),c()):b.pause()}f&&a.cancel(f);var e=+b.interval;!isNaN(e)&&0<=e&&(f=a(d,e))}var d=this,g=d.slides=[],h=-1,f,k;d.currentSlide=null;d.select=function(f,j){function k(){if(d.currentSlide&&angular.isString(j)&&!b.noTransition&&f.$element){f.$element.addClass(j);f.$element.attr("offsetWidth",f.$element[0].offsetWidth);
angular.forEach(g,function(a){angular.extend(a,{direction:"",entering:!1,leaving:!1,active:!1})});angular.extend(f,{direction:j,active:!0,entering:!0});angular.extend(d.currentSlide||{},{direction:j,leaving:!0});b.$currentTransition=e(f.$element,{});var a=f,m=d.currentSlide;b.$currentTransition.then(function(){q(a,m)},function(){q(a,m)})}else q(f,d.currentSlide);d.currentSlide=f;h=p;c()}function q(a,d){angular.extend(a,{direction:"",active:!0,leaving:!1,entering:!1});angular.extend(d||{},{direction:"",
active:!1,leaving:!1,entering:!1});b.$currentTransition=null}var p=g.indexOf(f);void 0===j&&(j=p>h?"next":"prev");f&&f!==d.currentSlide&&(b.$currentTransition?(b.$currentTransition.cancel(),a(k)):k())};d.indexOfSlide=function(a){return g.indexOf(a)};b.next=function(){return d.select(g[(h+1)%g.length],"next")};b.prev=function(){return d.select(g[0>h-1?g.length-1:h-1],"prev")};b.select=function(a){d.select(a)};b.isActive=function(a){return d.currentSlide===a};b.slides=function(){return g};b.$watch("interval",
c);b.play=function(){k||(k=!0,c())};b.pause=function(){k=!1;f&&a.cancel(f)};d.addSlide=function(a,c){a.$element=c;g.push(a);1===g.length||a.active?(d.select(g[g.length-1]),1==g.length&&b.play()):a.active=!1};d.removeSlide=function(a){var b=g.indexOf(a);g.splice(b,1);0<g.length&&a.active&&(b>=g.length?d.select(g[b-1]):d.select(g[b]))}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",
scope:{interval:"=",noTransition:"="}}}]).directive("slide",[function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"="},link:function(b,a,e,c){c.addSlide(b,a);b.$on("$destroy",function(){c.removeSlide(b)});b.$watch("active",function(a){a&&c.select(b)})}}}]);var dialogModule=angular.module("ui.bootstrap.dialog",["ui.bootstrap.transition"]);
dialogModule.controller("MessageBoxController",["$scope","dialog","model",function(b,a,e){b.title=e.title;b.message=e.message;b.buttons=e.buttons;b.close=function(b){a.close(b)}}]);
dialogModule.provider("$dialog",function(){var b={backdrop:!0,dialogClass:"modal",backdropClass:"modal-backdrop",transitionClass:"fade",triggerClass:"in",dialogOpenClass:"modal-open",resolve:{},backdropFade:!1,dialogFade:!1,keyboard:!0,backdropClick:!0},a={},e=0;this.options=function(b){a=b};this.$get=["$http","$document","$compile","$rootScope","$controller","$templateCache","$q","$transition","$injector",function(c,d,g,h,f,k,l,j,m){function q(a){var b=angular.element("<div>");b.addClass(a);return b}
function p(d){var c=this;d=this.options=angular.extend({},b,a,d);this._open=!1;this.backdropEl=q(d.backdropClass);d.backdropFade&&(this.backdropEl.addClass(d.transitionClass),this.backdropEl.removeClass(d.triggerClass));this.modalEl=q(d.dialogClass);d.dialogFade&&(this.modalEl.addClass(d.transitionClass),this.modalEl.removeClass(d.triggerClass));this.handledEscapeKey=function(a){27===a.which&&(c.close(),a.preventDefault(),c.$scope.$apply())};this.handleBackDropClick=function(a){c.close();a.preventDefault();
c.$scope.$apply()}}var r=d.find("body");p.prototype.isOpen=function(){return this._open};p.prototype.open=function(a,b){var d=this,c=this.options;a&&(c.templateUrl=a);b&&(c.controller=b);if(!c.template&&!c.templateUrl)throw Error("Dialog.open expected template or templateUrl, neither found. Use options or open method to specify them.");this._loadResolves().then(function(a){var b=a.$scope=d.$scope=a.$scope?a.$scope:h.$new();d.modalEl.html(a.$template);d.options.controller&&(a=f(d.options.controller,
a),d.modalEl.contents().data("ngControllerController",a));g(d.modalEl)(b);d._addElementsToDom();r.addClass(d.options.dialogOpenClass);setTimeout(function(){d.options.dialogFade&&d.modalEl.addClass(d.options.triggerClass);d.options.backdropFade&&d.backdropEl.addClass(d.options.triggerClass)});d._bindEvents()});this.deferred=l.defer();return this.deferred.promise};p.prototype.close=function(a){function b(a){a.removeClass(c.options.triggerClass)}function d(){c._open&&c._onCloseComplete(a)}var c=this,
e=this._getFadingElements();r.removeClass(c.options.dialogOpenClass);if(0<e.length)for(var f=e.length-1;0<=f;f--)j(e[f],b).then(d);else this._onCloseComplete(a)};p.prototype._getFadingElements=function(){var a=[];this.options.dialogFade&&a.push(this.modalEl);this.options.backdropFade&&a.push(this.backdropEl);return a};p.prototype._bindEvents=function(){this.options.keyboard&&r.bind("keydown",this.handledEscapeKey);this.options.backdrop&&this.options.backdropClick&&this.backdropEl.bind("click",this.handleBackDropClick)};
p.prototype._unbindEvents=function(){this.options.keyboard&&r.unbind("keydown",this.handledEscapeKey);this.options.backdrop&&this.options.backdropClick&&this.backdropEl.unbind("click",this.handleBackDropClick)};p.prototype._onCloseComplete=function(a){this._removeElementsFromDom();this._unbindEvents();this.deferred.resolve(a)};p.prototype._addElementsToDom=function(){r.append(this.modalEl);this.options.backdrop&&(0===e&&r.append(this.backdropEl),e++);this._open=!0};p.prototype._removeElementsFromDom=
function(){this.modalEl.remove();this.options.backdrop&&(e--,0===e&&this.backdropEl.remove());this._open=!1};p.prototype._loadResolves=function(){var a=[],b=[],d,e=this;this.options.template?d=l.when(this.options.template):this.options.templateUrl&&(d=c.get(this.options.templateUrl,{cache:k}).then(function(a){return a.data}));angular.forEach(this.options.resolve||[],function(d,c){b.push(c);a.push(angular.isString(d)?m.get(d):m.invoke(d))});b.push("$template");a.push(d);return l.all(a).then(function(a){var d=
{};angular.forEach(a,function(a,c){d[b[c]]=a});d.dialog=e;return d})};return{dialog:function(a){return new p(a)},messageBox:function(a,b,d){return new p({templateUrl:"template/dialog/message.html",controller:"MessageBoxController",resolve:{model:function(){return{title:a,message:b,buttons:d}}}})}}}]});
angular.module("ui.bootstrap.dropdownToggle",[]).directive("dropdownToggle",["$document","$location","$window",function(b){var a=null,e=angular.noop;return{restrict:"CA",link:function(c,d){c.$watch("$location.path",function(){e()});d.parent().bind("click",function(){e()});d.bind("click",function(c){c.preventDefault();c.stopPropagation();c=d===a;a&&e();c||(d.parent().addClass("open"),a=d,e=function(c){c&&(c.preventDefault(),c.stopPropagation());b.unbind("click",e);d.parent().removeClass("open");e=
angular.noop;a=null},b.bind("click",e))})}}}]);
angular.module("ui.bootstrap.modal",["ui.bootstrap.dialog"]).directive("modal",["$parse","$dialog",function(b,a){return{restrict:"EA",terminal:!0,link:function(e,c,d){var g=angular.extend({},e.$eval(d.uiOptions||d.bsOptions||d.options)),h=d.modal||d.show,f,g=angular.extend(g,{template:c.html(),resolve:{$scope:function(){return e}}}),k=a.dialog(g);c.remove();f=d.close?function(){b(d.close)(e)}:function(){angular.isFunction(b(h).assign)&&b(h).assign(e,!1)};e.$watch(h,function(a){a?k.open().then(function(){f()}):
k.isOpen()&&k.close()})}}}]);
angular.module("ui.bootstrap.pagination",[]).constant("paginationConfig",{boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last"}).directive("pagination",["paginationConfig",function(b){return{restrict:"EA",scope:{numPages:"=",currentPage:"=",maxSize:"=",onSelectPage:"&"},templateUrl:"template/pagination/pagination.html",replace:!0,link:function(a,e,c){function d(a,b,d,c){return{number:a,text:b,active:d,disabled:c}}var g=angular.isDefined(c.boundaryLinks)?
a.$eval(c.boundaryLinks):b.boundaryLinks,h=angular.isDefined(c.directionLinks)?a.$eval(c.directionLinks):b.directionLinks,f=angular.isDefined(c.firstText)?c.firstText:b.firstText,k=angular.isDefined(c.previousText)?c.previousText:b.previousText,l=angular.isDefined(c.nextText)?c.nextText:b.nextText,j=angular.isDefined(c.lastText)?c.lastText:b.lastText;a.$watch("numPages + currentPage + maxSize",function(){a.pages=[];var b=1,c=a.numPages;a.maxSize&&a.maxSize<a.numPages&&(b=Math.max(a.currentPage-Math.floor(a.maxSize/
2),1),c=b+a.maxSize-1,c>a.numPages&&(c=a.numPages,b=c-a.maxSize+1));for(;b<=c;b++){var e=d(b,b,a.isActive(b),!1);a.pages.push(e)}h&&(c=d(a.currentPage-1,k,!1,a.noPrevious()),a.pages.unshift(c),c=d(a.currentPage+1,l,!1,a.noNext()),a.pages.push(c));g&&(c=d(1,f,!1,a.noPrevious()),a.pages.unshift(c),c=d(a.numPages,j,!1,a.noNext()),a.pages.push(c));a.currentPage>a.numPages&&a.selectPage(a.numPages)});a.noPrevious=function(){return 1===a.currentPage};a.noNext=function(){return a.currentPage===a.numPages};
a.isActive=function(b){return a.currentPage===b};a.selectPage=function(b){!a.isActive(b)&&(0<b&&b<=a.numPages)&&(a.currentPage=b,a.onSelectPage({page:b}))}}}}]);
angular.module("ui.bootstrap.tooltip",[]).provider("$tooltip",function(){var b={placement:"top",animation:!0,popupDelay:0},a={};this.options=function(b){angular.extend(a,b)};this.$get=["$window","$compile","$timeout","$parse","$document",function(e,c,d,g,h){return function(f,k,l,j){var m=angular.extend({},b,a),q;q=f.replace(/[A-Z]/g,function(a,b){return(b?"-":"")+a.toLowerCase()});var p="<"+q+'-popup title="{{tt_title}}" content="{{tt_content}}" placement="{{tt_placement}}" animation="tt_animation()" is-open="tt_isOpen"></'+
q+"-popup>";return{restrict:"EA",scope:!0,link:function(a,b,q){function w(){a.tt_popupDelay?z=d(x,a.tt_popupDelay):a.$apply(x)}function x(){var c,f,g,j,k,l;if(a.tt_content){u&&d.cancel(u);s.css({top:0,left:0,display:"block"});m.appendToBody?(v=v||h.find("body"),v.append(s)):b.after(s);f=b;j=f[0].getBoundingClientRect();c=f.prop("offsetWidth");f=f.prop("offsetHeight");g=j.top+e.pageYOffset;j=j.left+e.pageXOffset;k=s.prop("offsetWidth");l=s.prop("offsetHeight");switch(a.tt_placement){case "right":c=
{top:g+f/2-l/2+"px",left:j+c+"px"};break;case "bottom":c={top:g+f+"px",left:j+c/2-k/2+"px"};break;case "left":c={top:g+f/2-l/2+"px",left:j-k+"px"};break;default:c={top:g-l+"px",left:j+c/2-k/2+"px"}}s.css(c);a.tt_isOpen=!0}}function y(){a.tt_isOpen=!1;d.cancel(z);angular.isDefined(a.tt_animation)&&a.tt_animation()?u=d(function(){s.remove()},500):s.remove()}var s=c(p)(a),u,z,v;q.$observe(f,function(b){a.tt_content=b});q.$observe(k+"Title",function(b){a.tt_title=b});q.$observe(k+"Placement",function(b){a.tt_placement=
angular.isDefined(b)?b:m.placement});q.$observe(k+"Animation",function(b){a.tt_animation=angular.isDefined(b)?g(b):function(){return m.animation}});q.$observe(k+"PopupDelay",function(b){b=parseInt(b,10);a.tt_popupDelay=!isNaN(b)?b:m.popupDelay});a.tt_isOpen=!1;angular.isDefined(j)?(b.bind(l,function(){w()}),b.bind(j,function(){a.$apply(y)})):b.bind(l,function(){a.tt_isOpen?a.$apply(y):w()})}}}}]}).directive("tooltipPopup",function(){return{restrict:"E",replace:!0,scope:{content:"@",placement:"@",
animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(b){return b("tooltip","tooltip","mouseenter","mouseleave")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"E",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function(b){return b("tooltipHtmlUnsafe","tooltip","mouseenter","mouseleave")}]);
angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$compile","$timeout","$parse","$window","$tooltip",function(b,a,e,c,d){return d("popover","popover","click")}]);
angular.module("ui.bootstrap.progressbar",["ui.bootstrap.transition"]).constant("progressConfig",{animate:!0,autoType:!1,stackedTypes:["success","info","warning","danger"]}).controller("ProgressBarController",["$scope","$attrs","progressConfig",function(b,a,e){var c=angular.isDefined(a.animate)?b.$eval(a.animate):e.animate,d=angular.isDefined(a.autoType)?b.$eval(a.autoType):e.autoType,g=angular.isDefined(a.stackedTypes)?b.$eval("["+a.stackedTypes+"]"):e.stackedTypes;this.makeBar=function(a,b,e){var l=
angular.isObject(a)?a.value:a||0;b=angular.isObject(b)?b.value:b||0;a=angular.isObject(a)&&angular.isDefined(a.type)?a.type:d?g[e||0]:null;return{from:b,to:l,type:a,animate:c}};this.addBar=function(a){b.bars.push(a);b.totalPercent+=a.to};this.clearBars=function(){b.bars=[];b.totalPercent=0};this.clearBars()}]).directive("progress",function(){return{restrict:"EA",replace:!0,controller:"ProgressBarController",scope:{value:"=",onFull:"&",onEmpty:"&"},templateUrl:"template/progressbar/progress.html",
link:function(b,a,e,c){b.$watch("value",function(a,b){c.clearBars();if(angular.isArray(a))for(var e=0,f=a.length;e<f;e++)c.addBar(c.makeBar(a[e],b[e],e));else c.addBar(c.makeBar(a,b))},!0);b.$watch("totalPercent",function(a){if(100<=a)b.onFull();else if(0>=a)b.onEmpty()},!0)}}}).directive("progressbar",["$transition",function(b){return{restrict:"EA",replace:!0,scope:{width:"=",old:"=",type:"=",animate:"="},templateUrl:"template/progressbar/bar.html",link:function(a,e){a.$watch("width",function(c){a.animate?
(e.css("width",a.old+"%"),b(e,{width:c+"%"})):e.css("width",c+"%")})}}}]);
angular.module("ui.bootstrap.tabs",[]).controller("TabsController",["$scope","$element",function(b){var a=b.panes=[];this.select=b.select=function(b){angular.forEach(a,function(a){a.selected=!1});b.selected=!0};this.addPane=function(e){a.length||b.select(e);a.push(e)};this.removePane=function(e){var c=a.indexOf(e);a.splice(c,1);e.selected&&0<a.length&&b.select(a[c<a.length?c:c-1])}}]).directive("tabs",function(){return{restrict:"EA",transclude:!0,scope:{},controller:"TabsController",templateUrl:"template/tabs/tabs.html",
replace:!0}}).directive("pane",["$parse",function(b){return{require:"^tabs",restrict:"EA",transclude:!0,scope:{heading:"@"},link:function(a,e,c,d){var g,h;a.selected=!1;c.active&&(g=b(c.active),h=g.assign,a.$watch(function(){return g(a.$parent)},function(b){a.selected=b}),a.selected=g?g(a.$parent):!1);a.$watch("selected",function(b){b&&d.select(a);h&&h(a.$parent,b)});d.addPane(a);a.$on("$destroy",function(){d.removePane(a)})},templateUrl:"template/tabs/pane.html",replace:!0}}]);
angular.module("ui.bootstrap.typeahead",[]).factory("typeaheadParser",["$parse",function(b){var a=/^\s*(.*?)(?:\s+as\s+(.*?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+(.*)$/;return{parse:function(e){var c=e.match(a);if(!c)throw Error("Expected typeahead specification in form of '_modelValue_ (as _label_)? for _item_ in _collection_' but got '"+e+"'.");return{itemName:c[3],source:b(c[4]),viewMapper:b(c[2]||c[1]),modelMapper:b(c[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$document","typeaheadParser",
function(b,a,e,c,d){var g=[9,13,27,38,40];return{require:"ngModel",link:function(h,f,k,l){var j,m=h.$eval(k.typeaheadMinLength)||1,q=d.parse(k.typeahead),p=!1!==h.$eval(k.typeaheadEditable),r=a(k.typeaheadLoading).assign||angular.noop,n=h.$new();h.$on("$destroy",function(){n.$destroy()});var t=function(){n.matches=[];n.activeIdx=-1};t();n.query=void 0;l.$parsers.push(function(a){t();if(j)return a;if(a&&a.length>=m){var b={$viewValue:a};r(h,!0);e.when(q.source(n,b)).then(function(c){if(a===l.$viewValue){if(0<
c.length){n.activeIdx=0;for(var d=n.matches.length=0;d<c.length;d++)b[q.itemName]=c[d],n.matches.push({label:q.viewMapper(n,b),model:c[d]});n.query=a}else t();r(h,!1)}},function(){t();r(h,!1)})}return p?a:void 0});l.$render=function(){var a={};a[q.itemName]=j||l.$viewValue;f.val(q.viewMapper(n,a)||l.$viewValue);j=void 0};n.select=function(a){var b={};b[q.itemName]=j=n.matches[a].model;l.$setViewValue(q.modelMapper(n,b));l.$render()};f.bind("keydown",function(a){0===n.matches.length||-1===g.indexOf(a.which)||
(a.preventDefault(),40===a.which?(n.activeIdx=(n.activeIdx+1)%n.matches.length,n.$digest()):38===a.which?(n.activeIdx=(n.activeIdx?n.activeIdx:n.matches.length)-1,n.$digest()):13===a.which||9===a.which?n.$apply(function(){n.select(n.activeIdx)}):27===a.which&&(a.stopPropagation(),t(),n.$digest()))});c.find("body").bind("click",function(){t();n.$digest()});k=b("<typeahead-popup matches='matches' active='activeIdx' select='select(activeIdx)' query='query'></typeahead-popup>")(n);f.after(k)}}}]).directive("typeaheadPopup",
function(){return{restrict:"E",scope:{matches:"=",query:"=",active:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead.html",link:function(b){b.isOpen=function(){return 0<b.matches.length};b.isActive=function(a){return b.active==a};b.selectActive=function(a){b.active=a};b.selectMatch=function(a){b.select({activeIdx:a})}}}}).filter("typeaheadHighlight",function(){return function(b,a){return a?b.replace(RegExp(a.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"gi"),"<strong>$&</strong>"):
a}});(function(){angular.module("hutmap",["hutmapServices","hutmapFilters","AngularGM","ngResource","ui.bootstrap"])})();(function(){angular.module("hutmapServices",[]).factory("Huts",["$http",function(b){return{query:function(a,e,c){b.get("/huts/api/v1/hutsearch/",{params:a}).success(e).error(c)}}}]).factory("HutDB",["$http","$filter","$q",function(b,a,e){var c={},d=a("filter"),g=e.defer(),h;b.get("/static/data/huts.json").success(function(a){h=a;g.resolve()});c.query=function(a,b){return g.promise.then(function(){var c=a.bounds,e=d(h.objects,function(a){return c?(a=new google.maps.LatLng(a.location.coordinates[1],
a.location.coordinates[0]),c.contains(a)):!0});b({meta:{total_count:e.length},objects:e})})};return c}]).factory("Places",["$q",function(b){function a(a,b,c){c==google.maps.places.PlacesServiceStatus.OK?a.resolve(b):a.reject(c)}var e=angular.element('<div id="google-attributions"></div>'),c=new google.maps.places.PlacesService(e[0]),d=new google.maps.places.AutocompleteService;return{getDetails:function(d){var e=b.defer();c.getDetails({reference:d},angular.bind(this,a,e));return e.promise},textSearch:function(d){var e=
b.defer();c.textSearch(d,angular.bind(this,a,e));return e.promise},getPlacePredictions:function(c){var e=b.defer();d.getPlacePredictions({input:c},angular.bind(this,a,e));return e.promise}}}]).factory("utils",[function(){return{latLngFromUrlValue:function(b){b=b.split(",");return new google.maps.LatLng(b[0],b[1])},boundsFromUrlValue:function(b){b=b.split(",");return new google.maps.LatLngBounds(new google.maps.LatLng(b[0],b[1]),new google.maps.LatLng(b[2],b[3]))}}}])})();(function(){angular.module("hutmap").config(["$routeProvider","$locationProvider",function(b,a){b.when("/",{templateUrl:"/partials/home.html",activetab:"home"}).when("/map/",{templateUrl:"/partials/map.html",activetab:"map",reloadOnSearch:!1}).when("/about/",{templateUrl:"/partials/about.html",activetab:"about"});a.html5Mode(!0)}]).constant("hutmapMapId","map_canvas").value("mapOptions",{zoom:8,center:new google.maps.LatLng(46.87916,-120),mapTypeId:google.maps.MapTypeId.TERRAIN,streetViewControl:!1}).value("markerOptions",
{huts:{icon:"/static/img/marker_gray_small.png",shape:{coord:[6,0,2,2,0,6,6,13,12,6,10,2,6,0],type:"poly"},zIndex:0},filteredHuts:{icon:"/static/img/marker_red_small.png",shape:{coord:[6,0,2,2,0,6,6,13,12,6,10,2,6,0],type:"poly"},zIndex:1},selected:{icon:"/static/img/marker_yellow_small.png",zIndex:2}})})();(function(){angular.module("hutmapFilters",[]).filter("truncate",function(){return function(b,a,e){isNaN(a)&&(a=10);void 0===e&&(e="...");return null==b||0==b.length?null:b.length<=a||b.length-e.length<=a?b:String(b).substring(0,a-e.length)+e}})})();(function(){angular.module("hutmap.directives",[])})();(function(){angular.module("hutmap").controller("HutCtrl",["$scope","$location","$timeout","Huts","HutDB",function(b,a,e,c,d){var g=0;b.loading=0;b.huts;b.filteredHuts;b.hutsMeta;b.query;b.selectedHut;b.selectedHutRegion;b.selectedHutAgency;b.resetLoading=function(){b.loading=0};b.incLoading=function(){b.loading++};b.decLoading=function(){0<b.loading&&b.loading--};b.setQuery=function(a){b.query=a};b.setSelectedHut=function(a){b.selectedHut=a};b.setFilteredHuts=function(a){b.filteredHuts=a};b.$watch("query",
function(a){if(null!=a){var c=++g;e(function(){c===g&&a&&(b.incLoading(),d.query(a,function(a){b.decLoading();c===g&&(b.resetLoading(),b.huts=a.objects,b.hutsMeta=a.meta)},function(){b.decLoading()}))},1E3)}});b.$watch("hutsMeta.total_count",function(a){a&&console.log(a)})}])})();(function(){angular.module("hutmap").controller("HutmapCtrl",["$scope","$route",function(b,a){b.$route=a}]).controller("CarouselCtrl",["$scope","$route","$http","$q",function(b,a,e,c){b.slides=[{title:"Plummer Hut",location:"Waddington Range, British Columbia, Canada",hutLink:"/map/?m_selected=51.37361,-125.16458&m_center=51.388403,-125.062053&m_zoom=9",agency:{name:"BC Mountaineering Club",url:""},thumbnail:"/static/img/no-image-available.gif",image:"/static/img/carousel/Plummer Hut.JPG"},{title:"Joe River Chickee",
location:"lorem ipsum dolor",hutLink:"",agency:{name:"lorem ipsum dolor",url:""},thumbnail:"/static/img/no-image-available.gif",image:"/static/img/carousel/Joe River Chickee.JPG"},{title:"John Muir Shelter",location:"lorem ipsum dolor",hutLink:"",agency:{name:"lorem ipsum dolor",url:""},thumbnail:"/static/img/no-image-available.gif",image:"/static/img/carousel/John Muir Shelter.JPG"}];b.imgStyle=function(a){return{"background-image":"url('"+a+"')"}};b.carouselInterval=-1;var d=[];angular.forEach(b.slides,
function(a){d.push(e.get(a.image))});c.all(d).then(function(){b.carouselInterval=8E3})}]).controller("AlertCtrl",["$scope",function(b){b.alerts=[];b.addAlert=function(a,e){b.alerts.push({type:a,msg:e})};b.closeAlert=function(a){b.alerts.splice(a,1)}}]).controller("HutInfoCtrl",["$scope",function(b){b.accuracy_tooltip="Coordinates provided, but unverifiable.;Wild ass guess.;Slightly better than a wild ass guess.;Found structure on satellite or topo map.;Surveyed with GPS by the Hutmap team.;Found on a map and surveyed by the Hutmap team.".split(";")}])})();(function(){angular.module("hutmap").controller("SearchCtrl",["$scope","$location","$route","$log","Places",function(b,a,e,c,d){b.submitting=!1;b.autocompleting=0;b.lastQuery;b.selected;b.getPlaces=function(a){return(b.lastQuery=a)&&!b.submitting?(b.autocompleting++,d.getPlacePredictions(a).then(function(a){0<b.autocompleting&&b.autocompleting--;return b.submitting?[]:a},function(){0<b.autocompleting&&b.autocompleting--;return[]})):[]};var g=function(a){b.submitting=!1;c.error(a);b.addAlert("error",
"There was an error retrieving search results. TODO: better messages")},h=function(c){b.submitting=!1;e.reload();a.path("/map/").search({}).search("m_zoom",8);c.geometry.location&&(a.search("m_center",c.geometry.location.toUrlValue()),a.search("m_selected",c.geometry.location.toUrlValue()));c.geometry.viewport&&a.search("m_bounds",c.geometry.viewport.toUrlValue())};b.$watch("selected",function(a){a&&b.submit()});b.submit=function(){if(b.selected){b.submitting=!0;b.autocompleting=0;var a=b.selected;
a.reference&&d.getDetails(a.reference).then(function(a){h(a)},g)}else if(a=b.lastQuery)b.submitting=!0,b.autocompleting=0,d.getPlacePredictions(a).then(function(a){d.getDetails(a[0].reference).then(function(a){h(a)},g)},g)}}])})();(function(){angular.module("hutmap").controller("FilterCtrl",["$scope",function(b){b.season={winter:!0,summer:!0};b.shelterType={"emergency shelters":{include:!1,keywords:["Emergency Shelter","Refuge"]},"fire lookouts":{include:!0,keywords:["Fire Lookout"]},"huts & yurts":{include:!0,keywords:"Hut;Yurt;Chickee;Lean-to;Wall Tent;Shelter".split(";")},compounds:{include:!0,keywords:"Compound;Hostel;Tea House;Lodge;Chalet;Ranch".split(";")}};b.filter=function(){b.incLoading();var a={},e,c=[];angular.forEach(b.shelterType,
function(a){a.include&&(c=c.concat(a.keywords))});e=c;angular.forEach(b.huts,function(c){var g;g=b.season;g=!g.winter&&!g.summer?!c.open_winter&&!c.open_summer:g.winter&&c.open_winter||g.summer&&c.open_summer;if(g){var h=!1;angular.forEach(e,function(a){~c.types.indexOf(a)&&(h=!0)});g=h}g&&(a[c.id]=c)});b.setFilteredHuts(a);b.$broadcast("gmMarkersRedraw","huts");b.decLoading()};b.$watch("huts",function(){b.filter()})}])})();(function(){angular.module("hutmap").controller("MapConfigCtrl",["$scope","$http","hutmapMapId","angulargmContainer","mapOptions","markerOptions",function(b,a,e,c,d,g){a=c.getMapPromise(e);var h,f;b.hutmapMapId=e;b.mapOptions=d;b.markerOptions=g;b.getMarkerOptions=function(a){var c={title:a.name};return b.filteredHuts&&a.id in b.filteredHuts?angular.extend(c,b.markerOptions.filteredHuts):angular.extend(c,b.markerOptions.huts)};b.selectHut=function(a,c){if(h){var d=angular.extend({},g.huts,{icon:f});
h.setOptions(d)}h=a;f=a.getIcon();a.setOptions(g.selected);b.setSelectedHut(c)};a.then(function(a){var b={MSR_TOPO:new google.maps.ImageMapType({name:"MSR USGS",alt:"USGS topos from Microsoft Research",minZoom:1,maxZoom:15,tileSize:new google.maps.Size(256,256),isPng:!1,getTileUrl:function(b,c){var d=a.getProjection(),e=Math.pow(2,c),f=new google.maps.Point(256*b.x/e,256*(b.y+1)/e),e=new google.maps.Point(256*(b.x+1)/e,256*b.y/e),f=d.fromPointToLatLng(f),d=d.fromPointToLatLng(e);return"http://msrmaps.com/ogcmap.ashx?version=1.1.1&request=GetMap&Layers=drg&Styles=default&SRS=EPSG:4326&BBOX="+
[f.lng(),f.lat(),d.lng(),d.lat()].join()+"&width=256&height=256&format=image/jpeg"}}),ARC_GIS_USA:new google.maps.ImageMapType({name:"ArcGIS USA",alt:"ArcGIS USA Topos",minZoom:1,maxZoom:15,tileSize:new google.maps.Size(256,256),isPng:!0,getTileUrl:function(a,b){var c=1<<b,d=a.x%c;0>d&&(d+=c);return"http://services.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/"+parseInt(b)+"/"+a.y+"/"+d}}),ARC_GIS_WORLD:new google.maps.ImageMapType({name:"ArcGIS World",alt:"ArcGIS World Topos",
minZoom:1,maxZoom:15,tileSize:new google.maps.Size(256,256),isPng:!0,getTileUrl:function(a,b){var c=1<<b,d=a.x%c;0>d&&(d+=c);return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/"+parseInt(b)+"/"+a.y+"/"+d}})};angular.forEach(b,function(b){a.mapTypes.set(b.name,b)});a.setOptions({mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.TERRAIN,b.MSR_TOPO.name,b.ARC_GIS_USA.name,
b.ARC_GIS_WORLD.name]}});a.enableKeyDragZoom({key:"alt",visualEnabled:!0})})}])})();(function(){angular.module("hutmap").controller("MapCtrl",["$scope","$location","$timeout","$q","utils",function(b,a,e,c,d){var g=c.defer(),h=c.defer();b.center;b.zoom;b.bounds;b.hutMarkerEvents;var f=function(){h.promise.then(function(){b.setSelectedHut(null);var c=a.search().m_selected;null!=c&&(b.hutMarkerEvents=[{event:"click",locations:[d.latLngFromUrlValue(c)]}])})};e=function(c,d){if(c!==d&&(b.center&&a.search("m_center",b.center.toUrlValue()),b.zoom&&a.search("m_zoom",b.zoom),b.selectedHut)){var e=
b.selectedHut.location;a.search("m_selected",e.coordinates[1]+","+e.coordinates[0])}};b.$watch("center != null && zoom != null",function(a){a&&g.resolve()});b.$watch("huts != null",function(a){a&&h.resolve()});b.$watch("center",e);b.$watch("zoom",e);b.$watch("selectedHut",e);b.$watch("bounds",function(a){a&&b.setQuery({bounds:a})});b.$on("gmMarkersUpdated",function(a,b){"huts"===b&&f()});var k=a.search().m_center,l=a.search().m_zoom,j=a.search().m_bounds;a.search("m_center",null);a.search("m_zoom",
null);a.search("m_bounds",null);g.promise.then(function(){var a=null!=j;!a&&null!=k&&(b.center=d.latLngFromUrlValue(k));!a&&null!=l&&(b.zoom=Number(l));a&&(b.bounds=d.boundsFromUrlValue(j))});f()}])})();
